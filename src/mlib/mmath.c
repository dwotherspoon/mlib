#include <mlib/mmath.h>

/* From 0 to PI/2 in PI/(2 * 1024) steps) */
#define MMATH_SIN_256

#if defined(MMATH_SIN_1024)
static const double mmath_sin_table[] = {
    0.000000000000000000000, 0.001535479676980091527, 0.003070955733760933736, 0.004606424550151812583,
    0.006141882505979086304, 0.007677325981094715486, 0.009212751355384804844, 0.010748155008778136760,
    0.012283533321254699183, 0.013818882672854231747, 0.015354199443684754534, 0.016889480013931101182,
    0.018424720763863453726, 0.019959918073845884373, 0.021495068324344879934, 0.023030167895937876665,
    0.024565213169321802045, 0.026100200525321602674, 0.027635126344898772177, 0.029169987009159886043,
    0.030704778899365146871, 0.032239498396936898394, 0.033774141883468160319, 0.035308705740731180511,
    0.036843186350685924735, 0.038377580095488653122, 0.039911883357500406444, 0.041446092519295582579,
    0.042980203963670415845, 0.044514214073651539594, 0.046048119232504507170, 0.047581915823742298999,
    0.049115600231133878240, 0.050649168838712711749, 0.052182618030785270224, 0.053715944191939569985,
    0.055249143707053714747, 0.056782212961304388832, 0.058315148340175398944, 0.059847946229466174317,
    0.061380603015300322367, 0.062913115084134121902, 0.064445478822765051019, 0.065977690618340301132,
    0.067509746858365304867, 0.069041643930712257027, 0.070573378223628607797, 0.072104946125745583707,
    0.073636344026086750225, 0.075167568314076449454, 0.076698615379548334969, 0.078229481612753962172,
    0.079760163404371170470, 0.081290657145512687509, 0.082820959227734594621, 0.084351066043044875542,
    0.085880973983911840230, 0.087410679443272742972, 0.088940178814542192320, 0.090469468491620699813,
    0.091998544868903173177, 0.093527404341287437295, 0.095056043304182658016, 0.096584458153517974144,
    0.098112645285750837987, 0.099640601097875661218, 0.101168321987432183184, 0.102695804352514033497,
    0.104223044591777252998, 0.105750039104448675942, 0.107276784290334520344, 0.108803276549828867314,
    0.110329512283922070992, 0.111855487894209321142, 0.113381199782899108608, 0.114906644352821690758,
    0.116431818007437570817, 0.117956717150846004949, 0.119481338187793467709, 0.121005677523682117491,
    0.122529731564578261982, 0.124053496717220879120, 0.125576969389030040913, 0.127100145988115420526,
    0.128623022923284702212, 0.130145596604052116163, 0.131667863440646876194, 0.133189819844021645201,
    0.134711462225860972852, 0.136232786998589788796, 0.137753790575381868111, 0.139274469370168241245,
    0.140794819797645659465, 0.142314838273285143577, 0.143834521213340282841, 0.145353865034855755933,
    0.146872866155675851907, 0.148391520994452796867, 0.149909825970655219418, 0.151427777504576671630,
    0.152945372017343983462, 0.154462605930925728215, 0.155979475668140743494, 0.157495977652666346858,
    0.159012108309046995558, 0.160527864062702640968, 0.162043241339937110768, 0.163558236567946546636,
    0.165072846174827869703, 0.166587066589587190490, 0.168100894242148191093, 0.169614325563360590632,
    0.171127356985008527435, 0.172639984939819024490, 0.174152205861470260606, 0.175664016184600174642,
    0.177175412344814736665, 0.178686390778696357895, 0.180196947923812356152, 0.181707080218723338039,
    0.183216784102991553373, 0.184726056017189332881, 0.186234892402907387110, 0.187743289702763410665,
    0.189251244360410214584, 0.190758752820544247308, 0.192265811528914032369, 0.193772416932328356287,
    0.195278565478664872801, 0.196784253616878290760, 0.198289477797008839577, 0.199794234470190651409,
    0.201298520088660087834, 0.202802331105764066521, 0.204305663975968554436, 0.205808515154866783492,
    0.207310881099187716003, 0.208812758266804260332, 0.210314143116741847361, 0.211815032109186562881,
    0.213315421705493557525, 0.214815308368195456712, 0.216314688561010631807, 0.217813558748851554547,
    0.219311915397833123720, 0.220809754975281075096, 0.222307073949740141572, 0.223803868790982574133,
    0.225300135970016301989, 0.226795871959093370274, 0.228291073231718183445, 0.229785736262655831963,
    0.231279857527940474471, 0.232773433504883553447, 0.234266460672082149630, 0.235758935509427225430,
    0.237250854498112034863, 0.238742214120640339203, 0.240233010860834678146, 0.241723241203844751990,
    0.243212901636155637286, 0.244701988645596058003, 0.246190498721346739952, 0.247678428353948598684,
    0.249165774035311121670, 0.250652532258720528446, 0.252138699518848097281, 0.253624272311758491849,
    0.255109247134917782596, 0.256593620487202023206, 0.258077388868905299724, 0.259560548781748057223,
    0.261043096728885259949, 0.262525029214914884523, 0.264006342745885691503, 0.265487033829306051658,
    0.266967098974151662016, 0.268446534690874094586, 0.269925337491408900981, 0.271403503889183828068,
    0.272881030399127144648, 0.274357913537675746074, 0.275834149822783369910, 0.277309735773928867086,
    0.278784667912124362044, 0.280258942759923523891, 0.281732556841429671035, 0.283205506682304042343,
    0.284677788809773901768, 0.286149399752640809513, 0.287620336041288837681, 0.289090594207692563877,
    0.290560170785425453399, 0.292029062309668019370, 0.293497265317215760838, 0.294964776346487600467,
    0.296431591937533933656, 0.297897708632044788679, 0.299363122973357931311, 0.300827831506467135991,
    0.302291830778030179427, 0.303755117336377167270, 0.305217687731518472205, 0.306679538515153005118,
    0.308140666240676264209, 0.309601067463188606155, 0.311060738739503184203, 0.312519676628154163822,
    0.313977877689404716310, 0.315435338485255456487, 0.316892055579452103231, 0.318348025537493972692,
    0.319803244926641694335, 0.321257710315925759659, 0.322711418276154127227, 0.324164365379920771382,
    0.325616548201613398295, 0.327067963317421661618, 0.328518607305345211600, 0.329968476745201966249,
    0.331417568218635771871, 0.332865878309124840762, 0.334313403601989522773, 0.335760140684400576472,
    0.337206086145387162745, 0.338651236575844671872, 0.340095588568543161223, 0.341539138718134960282,
    0.342981883621163052833, 0.344423819876068848522, 0.345864944083200398506, 0.347305252844820278035,
    0.348744742765113580063, 0.350183410450196075381, 0.351621252508122095204, 0.353058265548892413754,
    0.354494446184462630445, 0.355929791028750663884, 0.357364296697645189571, 0.358797959809013189414,
    0.360230776982708333911, 0.361662744840578587180, 0.363093860006474533630, 0.364524119106257038503,
    0.365953518767805296985, 0.367382055621024772307, 0.368809726297855355881, 0.370236527432278916816,
    0.371662455660327517570, 0.373087507620091296534, 0.374511679951726350613, 0.375934969297462673321,
    0.377357372301612037369, 0.378778885610576043774, 0.380199505872853782407, 0.381619229739050047634,
    0.383038053861882887841, 0.384455974896191821077, 0.385872989498945495601, 0.387289094329249627968,
    0.388704286048355107663, 0.390118561319665324572, 0.391531916808744717695, 0.392944349183325991604,
    0.394355855113318554128, 0.395766431270815954857, 0.397176074330103767718, 0.398584780967667751117,
    0.399992547862201341946, 0.401399371694613538164, 0.402805249148036947915, 0.404210176907835339044,
    0.405614151661611688215, 0.407017170099215730428, 0.408419228912752008132, 0.409820324796587531768,
    0.411220454447359606842, 0.412619614563983660993, 0.414017801847660960046, 0.415415013001886435084,
    0.416811244732456398498, 0.418206493747476371059, 0.419600756757368853478, 0.420994030474881042458,
    0.422386311615092546745, 0.423777596895423158685, 0.425167883035640736811, 0.426557166757868588824,
    0.427945444786593687247, 0.429332713848673941381, 0.430718970673346135403, 0.432104211992233644413,
    0.433488434539354094976, 0.434871635051127025662, 0.436253810266381658600, 0.437634956926364560026,
    0.439015071774747356326, 0.440394151557634283556, 0.441772193023570070025, 0.443149192923547319278,
    0.444525148011014503702, 0.445900055041883291995, 0.447273910774536542778, 0.448646711969835632061,
    0.450018455391128169296, 0.451389137804255824449, 0.452758755977561655470, 0.454127306681898046392,
    0.455494786690634034798, 0.456861192779662972363, 0.458226521727410407436, 0.459590770314841245980,
    0.460953935325467634154, 0.462316013545356563341, 0.463677001763137197621, 0.465036896770008645330,
    0.466395695359747564090, 0.467753394328715543793, 0.469109990475866822646, 0.470465480602755559136,
    0.471819861513543936660, 0.473173130015008935878, 0.474525282916550550372, 0.475876317030198947577,
    0.477226229170622018305, 0.478575016155132926254, 0.479922674803697602020, 0.481269201938942403629,
    0.482614594386161277484, 0.483958848973323474407, 0.485301962531081043650, 0.486643931892776104853,
    0.487984753894448619604, 0.489324425374843552383, 0.490662943175418475583, 0.492000304140351008009,
    0.493336505116546253369, 0.494671542953644183260, 0.496005414504027075662, 0.497338116622827119961,
    0.498669646167933466874, 0.500000000000000000000, 0.501329174982452441256, 0.502657167981496066922,
    0.503983975866122646536, 0.505309595508118380991, 0.506634023782070896935, 0.507957257565376574249,
    0.509279293738248095558, 0.510600129183721995751, 0.511919760787665323321, 0.513238185438783856007,
    0.514555400028628762144, 0.515871401451604261190, 0.517186186604974618142, 0.518499752388872137132,
    0.519812095706303600728, 0.521123213463158374559, 0.522433102568214957628, 0.523741759933148864903,
    0.525049182472539621713, 0.526355367103878202251, 0.527660310747574023971, 0.528964010326962497111,
    0.530266462768312130116, 0.531567665000831746092, 0.532867613956677921294, 0.534166306570962090561,
    0.535463739781757541714, 0.536759910530106965076, 0.538054815760029669924, 0.539348452418528578889,
    0.540640817455597555430, 0.541931907824228620285, 0.543221720480418834853, 0.544510252383177961732,
    0.545797500494535348103, 0.547083461779547142179, 0.548368133206303398630, 0.549651511745935295039,
    0.550933594372622126301, 0.552214378063598854141, 0.553493859799162657431, 0.554772036562680481708,
    0.556048905340595922553, 0.557324463122436442042, 0.558598706900820363153, 0.559871633671464308257,
    0.561143240433189749439, 0.562413524187930224940, 0.563682481940738888682, 0.564950110699795060576,
    0.566216407476411220934, 0.567481369285040671002, 0.568744993143283639192, 0.570007276071895385705,
    0.571268215094792308761, 0.572527807239059383093, 0.573786049534957376395, 0.575042939015929177593,
    0.576298472718607568410, 0.577552647682821662656, 0.578805460951604233699, 0.580056909571198153763,
    0.581306990591064165486, 0.582555701063887210189, 0.583803038045583533311, 0.585048998595307678805,
    0.586293579775459372527, 0.587536778651690627662, 0.588778592292912295036, 0.590019017771301501618,
    0.591258052162307867761, 0.592495692544661167744, 0.593731936000377324980, 0.594966779614766405615,
    0.596200220476438391692, 0.597432255677310730668, 0.598662882312614996749, 0.599892097480903885298,
    0.601119898284057430082, 0.602346281827290885857, 0.603571245219160612550, 0.604794785571571291705,
    0.606016899999783031916, 0.607237585622417253006, 0.608456839561464679633, 0.609674658942291114450,
    0.610891040893644765575, 0.612105982547662796911, 0.613319481039878322548, 0.614531533509226846057,
    0.615742137098053143873, 0.616951288952118037656, 0.618158986220605166650, 0.619365226056127760046,
    0.620570005614734854227, 0.621773322055918842288, 0.622975172542621247196, 0.624175554241240271303,
    0.625374464321636791553, 0.626571899957141575932, 0.627767858324561500716, 0.628962336604186433853,
    0.630155331979795785280, 0.631346841638665279284, 0.632536862771573726860, 0.633725392572809020919,
    0.634912428240175352734, 0.636097966974999762257, 0.637282005982138355371, 0.638464542469983520334,
    0.639645573650469589921, 0.640825096739080501962, 0.642003108954855350454, 0.643179607520395935083,
    0.644354589661872201312, 0.645528052609029900921, 0.646699993595196143126, 0.647870409857286722044,
    0.649039298635812111904, 0.650206657174884017358, 0.651372482722222256868, 0.652536772529160646883,
    0.653699523850654329316, 0.654860733945285100610, 0.656020400075268961260, 0.657178519506461888966,
    0.658335089508366722022, 0.659490107354139154516, 0.660643570320594508694, 0.661795475688214063226,
    0.662945820741151492506, 0.664094602767238972874, 0.665241819057994288045, 0.666387466908626158180,
    0.667531543618041789401, 0.668674046488852202863, 0.669814972827379340181, 0.670954319943662169656,
    0.672092085151462681480, 0.673228265768272882141, 0.674362859115320567582, 0.675495862517575762496,
    0.676627273303757381662, 0.677757088806339003106, 0.678885306361555418420, 0.680011923309409183069,
    0.681136936993676167518, 0.682260344761912662648, 0.683382143965460819857, 0.684502331959455756483,
    0.685620906102830884876, 0.686737863758325017827, 0.687853202292487808656, 0.688966919075686523577,
    0.690079011482112036902, 0.691189476889784715219, 0.692298312680561300780, 0.693405516240140462614,
    0.694511084958069235817, 0.695615016227749016764, 0.696717307446442002394, 0.697817956015277074400,
    0.698916959339255905448, 0.700014314827259176433, 0.701110019892052682700, 0.702204071950293440274,
    0.703296468422535792087, 0.704387206733237514200, 0.705476284310765588970, 0.706563698587402644335,
    0.707649446999352949028, 0.708733526986748296750, 0.709815935993654223424, 0.710896671468075669331,
    0.711975730861963529428, 0.713053111631220315481, 0.714128811235706262295, 0.715202827139245100874,
    0.716275156809630497712, 0.717345797718631605910, 0.718414747341999171404, 0.719482003159471417142,
    0.720547562654780149316, 0.721611423315656641542, 0.722673582633837408018, 0.723734038105070198732,
    0.724792787229119994663, 0.725849827509774780943, 0.726905156454851542058, 0.727958771576202035014,
    0.729010670389718673512, 0.730060850415340523156, 0.731109309177058741547, 0.732156044202923128594,
    0.733201053025047344569, 0.734244333179614683260, 0.735285882206884400247, 0.736325697651197264015,
    0.737363777060981218092, 0.738400117988757043186, 0.739434717991144685456, 0.740467574628868474562,
    0.741498685466763229890, 0.742528048073779478599, 0.743555660022990005942, 0.744581518891594851262,
    0.745605622260927303202, 0.746627967716459783887, 0.747648552847808955946, 0.748667375248742272831,
    0.749684432517182863798, 0.750699722255215529110, 0.751713242069092513198, 0.752724989569238944753,
    0.753734962370258387843, 0.754743158090938948135, 0.755749574354258268905, 0.756754208787389526236,
    0.757757059021706758095, 0.758758122692790859531, 0.759757397440434800728, 0.760754880908649289140,
    0.761750570745668209582, 0.762744464603954508419, 0.763736560140205411606, 0.764726855015357975809,
    0.765715346894594750538, 0.766702033447349107220, 0.767686912347311123384, 0.768669981272432467634,
    0.769651237904932283840, 0.770630679931302520203, 0.771608305042313591393, 0.772584110933019485579,
    0.773558095302763426560, 0.774530255855183091818, 0.775500590298216385676, 0.776469096344106546326,
    0.777435771709407585917, 0.778400614114989841674, 0.779363621286044971903, 0.780324790952091840168,
    0.781284120846981289255, 0.782241608708902247393, 0.783197252280386058132, 0.784151049308312697583,
    0.785102997543915770429, 0.786053094742787505922, 0.787001338664884420027, 0.787947727074532755509,
    0.788892257740433144875, 0.789834928435666383528, 0.790775736937698536799, 0.791714681028386157990,
    0.792651758493981395404, 0.793586967125137432433, 0.794520304716913705612, 0.795451769068780789596,
    0.796381357984626059299, 0.797309069272758241809, 0.798234900745913189546, 0.799158850221258876267,
    0.800080915520400171026, 0.801001094469384611330, 0.801919384898706844034, 0.802835784643314398501,
    0.803750291542612127493, 0.804662903440467869309, 0.805573618185217332766, 0.806482433629669093200,
    0.807389347631109477454, 0.808294358051308226010, 0.809197462756522933880, 0.810098659617504268660,
    0.810997946509501188572, 0.811895321312265605407, 0.812790781910057602566, 0.813684326191650542093,
    0.814575952050335727606, 0.815465657383927511326, 0.816353440094768290081, 0.817239298089733501307,
    0.818123229280236397010, 0.819005231582233261811, 0.819885302916227631798, 0.820763441207276289724,
    0.821639644384993150794, 0.822513910383554702754, 0.823386237141704557807, 0.824256622602758670659,
    0.825125064714610001460, 0.825991561429733067712, 0.826856110705189384369, 0.827718710502631682679,
    0.828579358788309239259, 0.829438053533072094936, 0.830294792712376383825, 0.831149574306288774217,
    0.832002396299491353560, 0.832853256681286513441, 0.833702153445601168436, 0.834549084590992196198,
    0.835394048120650656308, 0.836237042042406675257, 0.837078064368734220402, 0.837917113116755540858,
    0.838754186308246052484, 0.839589281969638889791, 0.840422398132029679907, 0.841253532831181205509,
    0.842082684107527623674, 0.842909850006179794946, 0.843735028576929280142, 0.844558217874253114310,
    0.845379415957318469665, 0.846198620889987540572, 0.847015830740821207279, 0.847831043583084587034,
    0.848644257494750919868, 0.849455470558506453571, 0.850264680861754773566, 0.851071886496621243801,
    0.851877085559957891725, 0.852680276153347516122, 0.853481456383108239017, 0.854280624360298057596,
    0.855077778200719174073, 0.855872916024922658629, 0.856666035958212668255, 0.857457136130650998673,
    0.858246214677061303178, 0.859033269737033755575, 0.859818299454929269032, 0.860601301979883825943,
    0.861382275465813029847, 0.862161218071416213249, 0.862938127960180989540, 0.863713003300387693884,
    0.864485842265113157978, 0.865256643032235595037, 0.866025403784438596588, 0.866792122709215684395,
    0.867556797998874085209, 0.868319427850539504732, 0.869080010466160124416, 0.869838544052510931337,
    0.870595026821197826017, 0.871349456988661952295, 0.872101832776184027196, 0.872852152409888004669,
    0.873600414120746071589, 0.874346616144582089447, 0.875090756722076146268, 0.875832834098768553410,
    0.876572846525064064416, 0.877310792256235871811, 0.878046669552430048000, 0.878780476678669097979,
    0.879512211904856733291, 0.880241873505781202702, 0.880969459761119844110, 0.881694968955443414416,
    0.882418399378219087126, 0.883139749323815781423, 0.883859017091507159769, 0.884576200985476179817,
    0.885291299314818980193, 0.886004310393548655256, 0.886715232540599695987, 0.887424064079831320662,
    0.888130803340032137783, 0.888835448654923476752, 0.889537998363163606719, 0.890238450808351622356,
    0.890936804339031329647, 0.891633057308695131660, 0.892327208075787914332, 0.893019255003711154295,
    0.893709196460826027497, 0.894397030820458294187, 0.895082756460901407536, 0.895766371765420621465,
    0.896447875122256432334, 0.897127264924629019838, 0.897804539570741688692, 0.898479697463784310330,
    0.899152737011937763789, 0.899823656628377266387, 0.900492454731276148472, 0.901159129743809517166,
    0.901823680094158364184, 0.902486104215512674465, 0.903146400546075756033, 0.903804567529067348630,
    0.904460603612727731537, 0.905114507250321165266, 0.905766276900139555295, 0.906415911025506004783,
    0.907063408094778589330, 0.907708766581354242753, 0.908351984963671421625, 0.908993061725214879232,
    0.909631995354518330110, 0.910268784345168557870, 0.910903427195808523820, 0.911535922410141252747,
    0.912166268496933385634, 0.912794463970018288279, 0.913420507348300159123, 0.914044397155756915829,
    0.914666131921444081065, 0.915285710179497891126, 0.915903130469139403758, 0.916518391334677273719,
    0.917131491325511194468, 0.917742428996136117014, 0.918351202906144470361, 0.918957811620230602401,
    0.919562253708193666490, 0.920164527744940952125, 0.920764632310491437650, 0.921362565989979120928,
    0.921958327373656016945, 0.922551915056896265632, 0.923143327640198463335, 0.923732563729189548596,
    0.924319621934628243842, 0.924904500872407830947, 0.925487199163559592918, 0.926067715434256255591,
    0.926646048315814985230, 0.927222196444701052265, 0.927796158462530162758, 0.928367933016072566232,
    0.928937518757256053270, 0.929504914343168509028, 0.930070118436061910039, 0.930633129703354988749,
    0.931193946817636564184, 0.931752568456668428531, 0.932308993303388899854, 0.932863220045915597645,
    0.933415247377548329411, 0.933965073996772865428, 0.934512698607263381234, 0.935058119917885677275,
    0.935601336642700509572, 0.936142347500966032214, 0.936681151217141461096, 0.937217746520889738449,
    0.937752132147080419422, 0.938284306835793002755, 0.938814269332319706329, 0.939342018387168131710,
    0.939867552756064927877, 0.940390871199958122695, 0.940911972485020120516, 0.941430855382650921825,
    0.941947518669480565734, 0.942461961127372682689, 0.942974181543426381857, 0.943484178709980247923,
    0.943991951424614117450, 0.944497498490152853634, 0.945000818714668455733, 0.945501910911483278710,
    0.946000773899172475723, 0.946497406501567217774, 0.946991807547757358243, 0.947483975872093764359,
    0.947973910314191647863, 0.948461609718932896484, 0.948947072936469071536, 0.949430298822223850408,
    0.949911286236895913149, 0.950390034046461606998, 0.950866541122177721945, 0.951340806340583822198,
    0.951812828583505021740, 0.952282606738055092954, 0.952750139696638242981, 0.953215426356952555409,
    0.953678465621991766632, 0.954139256400048818563, 0.954597797604717523967, 0.955054088154895786111,
    0.955508126974787486141, 0.955959912993905702727, 0.956409445147075043536, 0.956856722374433865674,
    0.957301743621436829201, 0.957744507838857894733, 0.958185013982791988774, 0.958623261014658334389,
    0.959059247901202116537, 0.959492973614497368651, 0.959924437131949415125, 0.960353637436296980745,
    0.960780573515614855218, 0.961205244363316113620, 0.961627648978154780934, 0.962047786364227719424,
    0.962465655530977293175, 0.962881255493193699557, 0.963294585271017411721, 0.963705643889940843927,
    0.964114430380811682220, 0.964520943779834105669, 0.964925183128571894997, 0.965327147473950319956,
    0.965726835868258248752, 0.966124247369150701559, 0.966519381039650848919, 0.966912235948152343212,
    0.967302811168421539101, 0.967691105779599491932, 0.968077118866204289205, 0.968460849518133271019,
    0.968842296830664806429, 0.969221459904460957979, 0.969598337845569258064, 0.969972929765424818349,
    0.970345234780852550216, 0.970715252014069274189, 0.971082980592685718335, 0.971448419649708294621,
    0.971811568323541652425, 0.972172425757990676942, 0.972530991102261710424, 0.972887263510965882851,
    0.973241242144119778068, 0.973592926167148320360, 0.973942314750886328767, 0.974289407071580626507,
    0.974634202310891928356, 0.974976699655896728025, 0.975316898299089407587, 0.975654797438383791786,
    0.975990396277115368484, 0.976323694024042953998, 0.976654689893350691499, 0.976983383104650049411,
    0.977309772882981153685, 0.977633858458815119263, 0.977955639068055715413, 0.978275113952040809018,
    0.978592282357544918092, 0.978907143536780322002, 0.979219696747398948844, 0.979529941252494484871,
    0.979837876320603595737, 0.980143501225708035918, 0.980446815247236203028, 0.980747817670064914175,
    0.981046507784520849249, 0.981342884886382660348, 0.981636948276882304043, 0.981928697262706706717,
    0.982218131155999540916, 0.982505249274362668643, 0.982790050940858028738, 0.983072535484008858120,
    0.983352702237801579166, 0.983630550541687354027, 0.983906079740583305870, 0.984179289184874517282,
    0.984450178230415362535, 0.984718746238530839854, 0.984984992576018458799, 0.985248916615149350484,
    0.985510517733670043938, 0.985769795314803798369, 0.986026748747252046456, 0.986281377425195837638,
    0.986533680748297392427, 0.986783658121701434673, 0.987031308956036301794, 0.987276632667416054190,
    0.987519628677440919340, 0.987760296413199623267, 0.987998635307269834627, 0.988234644797720274134,
    0.988468324328111380694, 0.988699673347497309805, 0.988928691310426488670, 0.989155377676943614595,
    0.989379731912590210108, 0.989601753488406621351, 0.989821441880932684221, 0.990038796572209278679,
    0.990253817049779438975, 0.990466502806689463867, 0.990676853341490359917, 0.990884868158238840685,
    0.991090546766498547981, 0.991293888681341162084, 0.991494893423347511963, 0.991693560518609129595,
    0.991889889498728472006, 0.992083879900821030695, 0.992275531267515664702, 0.992464843146956154918,
    0.992651815092802092266, 0.992836446664229876902, 0.993018737425933606389, 0.993198686948126630014,
    0.993376294806542103899, 0.993551560582434101221, 0.993724483862578722437, 0.993895064239274650397,
    0.994063301310344815676, 0.994229194679136840662, 0.994392743954524038763, 0.994553948750906302578,
    0.994712808688211325148, 0.994869323391895155062, 0.995023492492943084642, 0.995175315627870871182,
    0.995324792438725181043, 0.995471922573084588848, 0.995616705684060576687, 0.995759141430298089226,
    0.995899229475976421888, 0.996036969490810220051, 0.996172361150049923140, 0.996305404134482541778,
    0.996436098130432990061, 0.996564442829763974530, 0.996690437929877326440, 0.996814083133714556872,
    0.996935378149757411848, 0.997054322692028760500, 0.997170916480093039169, 0.997285159239057250602,
    0.997397050699571408039, 0.997506590597828868283, 0.997613778675567774989, 0.997718614680070725598,
    0.997821098364165992578, 0.997921229486227856498, 0.998019007810177161133, 0.998114433105482201647,
    0.998207505147158724590, 0.998298223715770927100, 0.998386588597431567926, 0.998472599583802966627,
    0.998556256472097003574, 0.998637559065076008125, 0.998716507171052758629, 0.998793100603891592648,
    0.998867339183007962866, 0.998939222733369769358, 0.999008751085497359590, 0.999075924075463528418,
    0.999140741544894628312, 0.999203203340970680379, 0.999263309316425596407, 0.999321059329547289884,
    0.999376453244178897251, 0.999429490929718000736, 0.999480172261117849608, 0.999528497118887138129,
    0.999574465389090227596, 0.999618076963347812480, 0.999659331738836920422, 0.999698229618291245302,
    0.999734770510001258259, 0.999768954327814540761, 0.999800780991135895626, 0.999830250424927680086,
    0.999857362559709805794, 0.999882117331559960860, 0.999904514682113942925, 0.999924554558565548135,
    0.999942236913666571141, 0.999957561705727471235, 0.999970528898617150304, 0.999981138461762508740,
    0.999989390370149777709, 0.999995284604323186883, 0.999998821150385963641, 1.000000000000000000000

};
#elif defined(MMATH_SIN_512)
static const double mmath_sin_table[] = {
    0.000000000000000000000, 0.003073960573355577573, 0.006147892100070983037, 0.009221765533780512669,
    0.012295551828667400374, 0.015369221939738273927, 0.018442746823097617287, 0.021516097436222198641,
    0.024589244738235521009, 0.027662159690182219068, 0.030734813255302462914, 0.033807176399306339276,
    0.036879220090648194563, 0.039950915300800964036, 0.043022233004530473222, 0.046093144180169701163,
    0.049163619809893012447, 0.052233630879990361473, 0.055303148381141441214, 0.058372143308689811159,
    0.061440586662916948923, 0.064508449449316301871, 0.067575702678867255457, 0.070642317368309032188,
    0.073708264540414597521, 0.076773515224264468615, 0.079838040455520439820, 0.082901811276699308162,
    0.085964798737446473931, 0.089026973894809513510, 0.092088307813511668942, 0.095148771566225254226,
    0.098208336233845019980, 0.101266972905761379331, 0.104324652680133633798, 0.107381346664163046523,
    0.110437025974365859993, 0.113491661736846244368, 0.116545225087569120914, 0.119597687172632860531,
    0.122649019148542051671, 0.125699192182479907443, 0.128748177452580797597, 0.131795946148202586246,
    0.134842469470198872417, 0.137887718631191064089, 0.140931664855840521611, 0.143974279381120284782,
    0.147015533456587049743, 0.150055398344652674014, 0.153093845320855875825, 0.156130845674133517109,
    0.159166370707092053038, 0.162200391736278537458, 0.165232880092451767107, 0.168263807120853203791,
    0.171293144181477591248, 0.174320862649343794049, 0.177346933914765136908, 0.180371329383619743991,
    0.183394020477620794951, 0.186414978634586586681, 0.189434175308710345265, 0.192451581970829954660,
    0.195467170108697629871, 0.198480911227249340323, 0.201492776848873872408, 0.204502738513682197352,
    0.207510767779776228448, 0.210516836223517522786, 0.213520915439796038493, 0.216522977042298475636,
    0.219522992663776395084, 0.222520933956314392876, 0.225516772591597969289, 0.228510480261181148087,
    0.231502028676753929259, 0.234491389570409741738, 0.237478534694912452041, 0.240463435823963261884,
    0.243446064752467467018, 0.246426393296801021782, 0.249404393295076742820, 0.252380036607410485061,
    0.255353295116187040126, 0.258324140726325812700, 0.261292545365546302616, 0.264258480984633392641,
    0.267221919557702358716, 0.270182833082463658148, 0.273141193580487662285, 0.276096973097468834091,
    0.279050143703490072244, 0.282000677493286555642, 0.284948546586509365852, 0.287893723127988943045,
    0.290836179287998486398, 0.293775887262516577358, 0.296712819273490246985, 0.299646947569097321651,
    0.302578244424008546698, 0.305506682139649765606, 0.308432233044463599558, 0.311354869494170682920,
    0.314274563872031287293, 0.317191288589106001883, 0.320105016084516524888, 0.323015718825706010797,
    0.325923369308699306668, 0.328827940058362910847, 0.331729403628664376580, 0.334627732602931937667,
    0.337522899594113301447, 0.340414877245034608322, 0.343303638228658891673, 0.346189155248344315741,
    0.349071401038102080427, 0.351950348362854048556, 0.354825970018690206587, 0.357698238833125459202,
    0.360567127665356812471, 0.363432609406519335771, 0.366294656979942789832, 0.369153243341407144573,
    0.372008341479398263463, 0.374859924415363143790, 0.377707965203964823875, 0.380552436933337068226,
    0.383393312725338386571, 0.386230565735806441463, 0.389064169154811401174, 0.391894096206909348101,
    0.394720320151395298591, 0.397542814282555889704, 0.400361551929921732906, 0.403176506458519379184,
    0.405987651269123117626, 0.408794959798506107873, 0.411598405519691623589, 0.414397961942203574282,
    0.417193602612316805089, 0.419985301113307174514, 0.422773031065701077047, 0.425556766127524632726,
    0.428336479994552932204, 0.431112146400558171599, 0.433883739117558120402, 0.436651231956063867745,
    0.439414598765327291119, 0.442173813433588192012, 0.444928849888321042982, 0.447679682096481235121,
    0.450426284064751214498, 0.453168629839786119007, 0.455906693508458804587, 0.458640449198104926953,
    0.461369871076767357199, 0.464094933353440208812, 0.466815610278312642656, 0.469531876143012061320,
    0.472243705280847081429, 0.474951072067050283909, 0.477653950919019909538, 0.480352316296561943076,
    0.483046142702131364732, 0.485735404681073068556, 0.488420076821862336747, 0.491100133756345036407,
    0.493775550159977261178, 0.496446300752064695327, 0.499112360296001533744, 0.501773703599508680284,
    0.504430305514872334705, 0.507082140939181025274, 0.509729184814563085482, 0.512371412128423520116,
    0.515008797913680260727, 0.517641317248999976997, 0.520268945259033777084, 0.522891657114652130822,
    0.525509428033179459838, 0.528122233278628283593, 0.530730048161933365414, 0.533332848041184193200,
    0.535930608321858792387, 0.538523304457055429495, 0.541110911947724648741, 0.543693406342901086603,
    0.546270763239934287192, 0.548842958284719184547, 0.551409967171926806984, 0.553971765645232872011,
    0.556528329497548157612, 0.559079634571246431030, 0.561625656758393154711, 0.564166372000973082024,
    0.566701756291117630937, 0.569231785671331702581, 0.571756436234720388789, 0.574275684125214125331,
    0.576789505537794955359, 0.579297876718721016509, 0.581800773965751139016, 0.584298173628368444632,
    0.586790052108004500653, 0.589276385858261808615, 0.591757151385136515032, 0.594232325247240122934,
    0.596701884056021314429, 0.599165804475986996103, 0.601624063224922567272, 0.604076637074111744141,
    0.606523502848556828049, 0.608964637427196642250, 0.611400017743126023007, 0.613829620783812868190,
    0.616253423591316296104, 0.618671403262503472043, 0.621083536949265324623, 0.623489801858733483364,
    0.625890175253495106844, 0.628284634451807377786, 0.630673156827812775305, 0.633055719811751904658,
    0.635432300890177437225, 0.637802877606166607194, 0.640167427559533153136, 0.642525928407039592649,
    0.644878357862607609619, 0.647224693697529329661, 0.649564913740677041254, 0.651898995878712583796,
    0.654226918056296291581, 0.656548658276295937775, 0.658864194599993902024, 0.661173505147294893192,
    0.663476568096932561858, 0.665773361686675557713, 0.668063864213533475933, 0.670348054033961804343,
    0.672625909564066204460, 0.674897409279806903548, 0.677162531717201754411, 0.679421255472529184161,
    0.681673559202530254808, 0.683919421624610612831, 0.686158821517041439542, 0.688391737719160068387,
    0.690618149131569825094, 0.692838034716339423724, 0.695051373497201918639, 0.697258144559752657266,
    0.699458327051647121841, 0.701651900182797771954, 0.703838843225570887085, 0.706019135514981743817,
    0.708192756448890681220, 0.710359685488197056813, 0.712519902157033868662, 0.714673386042960934184,
    0.716820116797157957933, 0.718960074134616489161, 0.721093237834331990399, 0.723219587739494795819,
    0.725339103757680514484, 0.727451765861039656436, 0.729557554086487480838, 0.731656448535892067753,
    0.733748429376262611967, 0.735833476839936717617, 0.737911571224767248722, 0.739982692894308624609,
    0.742046822278002005113, 0.744103939871360697822, 0.746154026236153899987, 0.748197062000591106568,
    0.750233027859504408852, 0.752261904574531348189, 0.754283672974296548475, 0.756298313954593015573,
    0.758305808478562548558, 0.760306137576875484818, 0.762299282347910445168, 0.764285223957932191574,
    0.766263943641270373064, 0.768235422700496051185, 0.770199642506599224667, 0.772156584499164244662,
    0.774106230186545340999, 0.776048561146041371295, 0.777983559024070125965, 0.779911205536341300970,
    0.781831482468029803634, 0.783744371673947393120, 0.785649855078714320911, 0.787547914676930416178,
    0.789438532533344505815, 0.791321690783024833671, 0.793197371631527148317, 0.795065557355062790812,
    0.796926230300667115536, 0.798779372886364913420, 0.800624967601337833578, 0.802462997006089029384,
    0.804293443732608248631, 0.806116290484535924499, 0.807931520037326489359, 0.809739115238411466535,
    0.811539059007361007758, 0.813331334336045985722, 0.815115924288797977226, 0.816892812002569912444,
    0.818661980687094836817, 0.820423413625045339082, 0.822177094172190536803, 0.823923005757554172135,
    0.825661131883571042245, 0.827391456126242319513, 0.829113962135291537869, 0.830828633634318469703,
    0.832535454420953335841, 0.834234408367009683261, 0.835925479418636929729, 0.837608651596471798229,
    0.839283908995789751373, 0.840951235786654760496, 0.842610616214069296781, 0.844262034598123101148,
    0.845905475334141065957, 0.847540922892831116719, 0.849168361820430761533, 0.850787776738853085412,
    0.852399152345832078481, 0.854002473415067187013, 0.855597724796367198330, 0.857184891415793681624,
    0.858763958275802985476, 0.860334910455388235384, 0.861897733110220332087, 0.863452411472787839664,
    0.864998930852537206704, 0.866537276636010878050, 0.868067434286985850633, 0.869589389346611008058,
    0.871103127433543344971, 0.872608634244084302445, 0.874105895552314771102, 0.875594897210229317075,
    0.877075625147870407972, 0.878548065373460640437, 0.880012203973535633850, 0.881468027113074814594,
    0.882915521035632977487, 0.884354672063469404719, 0.885785466597677872969, 0.887207891118314551093,
    0.888621932184526119869, 0.890027576434676670480, 0.891424810586473936880, 0.892813621437094862010,
    0.894193995863310164829, 0.895565920821608685287, 0.896929383348320397040, 0.898284370559738976070,
    0.899630869652243370105, 0.900968867902419145999, 0.902298352667178282793, 0.903619311383879186828,
    0.904931731570444597423, 0.906235600825480602794, 0.907530906828392658348, 0.908817637339502937266,
    0.910095780200165571650, 0.911365323332881449581, 0.912626254741412568094, 0.913878562510895608995,
    0.915122234807953627289, 0.916357259880809071895, 0.917583626059393697716, 0.918801321755459809992,
    0.920010335462689066155, 0.921210655756801499727, 0.922402271295663545025, 0.923585170819394951636,
    0.924759343150475254802, 0.925924777193849801726, 0.927081461937034001508, 0.928229386450217575089,
    0.929368539886368139058, 0.930498911481333235152, 0.931620490553942470768, 0.932733266506107994154,
    0.933837228822925191629, 0.934932367072771497440, 0.936018670907405425652, 0.937096130062063825683,
    0.938164734355559581935, 0.939224473690377203994, 0.940275338052768527852, 0.941317317512847084870,
    0.942350402224682359709, 0.943374582426392604972, 0.944389848440236989724, 0.945396190672706859814,
    0.946393599614617220261, 0.947382065841195553091, 0.948361580012171523357, 0.949332132871865130852,
    0.950293715249273862611, 0.951246318058159845421, 0.952189932297135221972, 0.953124549049747749052,
    0.954050159484564286316, 0.954966754855255173240, 0.955874326500676163576, 0.956772865844950248793,
    0.957662364397549481509, 0.958542813753374245422, 0.959414205592833302383, 0.960276531681922063122,
    0.961129783872300746950, 0.961973954101370987146, 0.962809034392352214304, 0.963635016854356929450,
    0.964451893682465755120, 0.965259657157800154970, 0.966058299647596485649, 0.966847813605277495164,
    0.967628191570523710219, 0.968399426169343935378, 0.969161510114145197115, 0.969914436203801133551,
    0.970658197323720495220, 0.971392786445914091509, 0.972118196629061293024, 0.972834421018575756790,
    0.973541452846669708165, 0.974239285432418555821, 0.974927912181823619342, 0.975607326587874523760,
    0.976277522230610594889, 0.976938492777181699545, 0.977590231981907975545, 0.978232733686339006596,
    0.978865991819311553890, 0.979490000397007620769, 0.980104753523010296945, 0.980710245388360046803,
    0.981306470271609332379, 0.981893422538876570194, 0.982471096643899532985, 0.983039487128087863255,
    0.983598588620574254549, 0.984148395838265854785, 0.984688903585893227088, 0.985220106756060642894,
    0.985742000329293266425, 0.986254579374085116328, 0.986757839046945584016, 0.987251774592445396905,
    0.987736381343261027332, 0.988211654720219212500, 0.988677590232340364196, 0.989134183476880535224,
    0.989581430139373163790, 0.990019325993670262775, 0.990447866901981610610, 0.990867048814914719301,
    0.991276867771512248950, 0.991677319899289977378, 0.992068401414273437489, 0.992450108621033222356,
    0.992822437912720179298, 0.993185385771099604746, 0.993538948766584217864, 0.993883123558266912134,
    0.994217906893951952618, 0.994543295610185840161, 0.994859286632287398433, 0.995165876974376639730,
    0.995463063739402742591, 0.995750844119172140445, 0.996029215394374278780, 0.996298174934607816411,
    0.996557720198405050382, 0.996807848733256451901, 0.997048558175633536926, 0.997279846251011070635,
    0.997501710773888938810, 0.997714149647812353905, 0.997917160865392172120, 0.998110742508323323108,
    0.998294892747403461719, 0.998469609842549732370, 0.998634892142815533411, 0.998790738086406282292,
    0.998937146200693737441, 0.999074115102229987073, 0.999201643496760993912, 0.999319730179238252532,
    0.999428374033830446699, 0.999527574033934107511, 0.999617329242182939275, 0.999697638810457145375,
    0.999768501979890866771, 0.999829918080879953557, 0.999881886533087960167, 0.999924406845451807513,
    0.999957478616186001830, 0.999981101532786964547, 0.999995275372035696826, 1.000000000000000000000
};
#elif defined(MMATH_SIN_256)
static const double mmath_sin_table[] = {
    0.000000000000000000000, 0.006159946638138647304, 0.012319659535238442274, 0.018478904959129904828,
    0.024637449195381973255, 0.030795058556170352981, 0.036951499389144895624, 0.043106538086295574652,
    0.049259941092816852959, 0.055411474915969954891, 0.061560906133942834562, 0.067708001404707451876,
    0.073852527474873960744, 0.079994251188541629083, 0.086132939496146004865, 0.092268359463302002110,
    0.098400278279642705570, 0.104528463267653470847, 0.110652681891500848099, 0.116772701765856315448,
    0.122888290664714128209, 0.128999216530203270059, 0.135105247481392964914, 0.141206151823091402564,
    0.147301698054637497659, 0.153391654878685362862, 0.159475791209980788388, 0.165553876184129977744,
    0.171625679166359623729, 0.177690969760268629996, 0.183749517816570340223, 0.189801093441825774466,
    0.195845467007166956774, 0.201882409157010250800, 0.207911690817759342575, 0.213933083206497426376,
    0.219946357839668621414, 0.225951286541747647929, 0.231947641453898151243, 0.237935195042618785610,
    0.243913720108377141127, 0.249882989794230819802, 0.255842777594435577537, 0.261792857363040309959,
    0.267733003322467910667, 0.273662990072082890070, 0.279582592596743839675, 0.285491586275342046353,
    0.291389746889324618984, 0.297276850631202682607, 0.303152674113043474335, 0.309016994374947451263,
    0.314869588893507856842, 0.320710235590255132720, 0.326538712840083289457, 0.332354799479659679395,
    0.338158274815817116998, 0.343948918633928124589, 0.349726511206261192477, 0.355490833300318054278,
    0.361241666187152921097, 0.366978791649672064779, 0.372701991990914027753, 0.378411050042310292962,
    0.384105749171925858754, 0.389785873292679385660, 0.395451206870542526506, 0.401101534932718772897,
    0.406736643075800208269, 0.412356317473903499771, 0.417960344886783408125, 0.423548512667924259567,
    0.429120608772608991277, 0.434676421765964937638, 0.440215740830987356524, 0.445738355776538253128,
    0.451244057045322832789, 0.456732635721840585230, 0.462203883540313165135, 0.467657592892586793099,
    0.473093556836010065147, 0.478511569101286560191, 0.483911424100301579276, 0.489292916933923627276,
    0.494655843399778805125, 0.500000000000000000000, 0.505325183948948097878, 0.510631193180906994833,
    0.515917826357751074795, 0.521184882876585042766, 0.526432162877355835917, 0.531659467250436112984,
    0.536866597644179988080, 0.542053356472449343606, 0.547219546922111166332, 0.552364972960505795641,
    0.557489439342885528816, 0.562592751619823139286, 0.567674716144590085776, 0.572735140080505189530,
    0.577773831408251115072, 0.582790598933160874928, 0.587785252292473137103, 0.592757601962554891983,
    0.597707459266093588113, 0.602634636379256405370, 0.607538946338816887582, 0.612420203049250044813,
    0.617278221289792927706, 0.622112816721473893544, 0.626923805894106456194, 0.631711006253250939579,
    0.636474236147141381181, 0.641213314833578351681, 0.645928062486787357699, 0.650618300204242161477,
    0.655283850013453572636, 0.659924534878722601761, 0.664540178707857975837, 0.669130606358858237570,
    0.673695643646557207340, 0.678235117349234029049, 0.682748855215185468381, 0.687236685969262683926,
    0.691698439319370028677, 0.696133945962926659057, 0.700543037593290951470, 0.704925546906147171278,
    0.709281307605853506004, 0.713610154411752239945, 0.717911923064441959141, 0.722186450332009344244,
    0.726433574016224103964, 0.730653132958693163346, 0.734844967046975661162, 0.739008917220659089509,
    0.743144825477394244118, 0.747252534878890983805, 0.751331889556873244729, 0.755382734718993753553,
    0.759404916654707107249, 0.763398282741102995885, 0.767362681448696903885, 0.771297962347180621201,
    0.775203976111129788862, 0.779080574525670477293, 0.782927610492102799000, 0.786744938033483220963,
    0.790532412300163356278, 0.794289889575286123247, 0.798017227280239493936, 0.801714283980066722002,
    0.805380919388832605676, 0.809016994374947451263, 0.812622370966445628504, 0.816196912356221715434,
    0.819740482907221124087, 0.823252948157587205458, 0.826734174825763501460, 0.830184030815550588756,
    0.833602385221119512870, 0.836989108331977815780, 0.840344071637892708893, 0.843667147833766284393,
    0.846958210824467094824, 0.850217135729614104100, 0.853443798888316007556, 0.856638077863862812400,
    0.859799851448372454144, 0.862928999667389673434, 0.866025403784438596588, 0.869088946305528353697,
    0.872119510983610846111, 0.875116982822992661717, 0.878081248083697918361, 0.881012194285784477898,
    0.883909710213611976570, 0.886773685920061893739, 0.889604012730709547974, 0.892400583247947798426,
    0.895163291355062340493, 0.897892032220258040631, 0.900586702300637420571, 0.903247199346128848418,
    0.905873422403367101197, 0.908465271819523634278, 0.911022649246088334074, 0.913545457642600866599,
    0.916033601280333509287, 0.918486985745923023572, 0.920905517944953677656, 0.923289106105489310039,
    0.925637659781556321192, 0.927951089856574595771, 0.930229308546740352170, 0.932472229404355812399,
    0.934679767321110577249, 0.936851838531310598945, 0.938988360615056527614, 0.941089252501371542614,
    0.943154434471277447471, 0.945183828160819583530, 0.947177356564040229259, 0.949134944035901262360,
    0.951056516295153531182, 0.952942000427156599152, 0.954791324886644310332, 0.956604419500440839030,
    0.958381215470122227451, 0.960121645374628074343, 0.961825643172819044757, 0.963493144205983087502,
    0.965124085200289028030, 0.966718404269187425726, 0.968276040915758917649, 0.969796936035009493615,
    0.971281031916113812841, 0.972728272244604785790, 0.974138602104510087365, 0.975511967980436600634,
    0.976848317759600681676, 0.978147600733805688833, 0.979409767601365888190, 0.980634770468977734481,
    0.981822562853536862093, 0.982973099683901785362, 0.984086337302604419186, 0.985162233467506531781,
    0.986200747353402573658, 0.987201839553568993857, 0.988165472081259377291, 0.989091608371145958323,
    0.989980213280706955459, 0.990831253091560282265, 0.991644695510742746336, 0.992420509671935735518,
    0.993158666136636170130, 0.993859136895273720391, 0.994521895368273289861, 0.995146916407064430210,
    0.995734176295034467685, 0.996283652748429449098, 0.996795324917199132564, 0.997269173385788021413,
    0.997705180173872885341, 0.998103328737044104280, 0.998463603967433943609, 0.998785992194289984347,
    0.999070481184493153215, 0.999317060143022906082, 0.999525719713365901065, 0.999696451977871602956,
    0.999829250458052709583, 0.999924110114830622109, 0.999981027348726847492, 1.000000000000000000000
};
#elif defined(MMATH_SIN_128)
static const double mmath_sin_table[] = {
    0.000000000000000000000, 0.012368159663362913309, 0.024734427279994957577, 0.037096911092605308613,
    0.049453719922738996473, 0.061802963460084105185, 0.074142752551646193271, 0.086471199490745734306,
    0.098786418305794140848, 0.111086525048804563021, 0.123369638083592969569, 0.135633878373625643698,
    0.147877369769468941518, 0.160098239295797473147, 0.172294617437916686153, 0.184464638427755900363,
    0.196606440529288523100, 0.208718166323335091450, 0.220797962991706203661, 0.232843982600641458136,
    0.244854382383501212317, 0.256827325022667973808, 0.268760978930614125026, 0.280653518530093071259,
    0.292503124533410874264, 0.304307984220736127412, 0.316066291717404579398, 0.327776248270176762123,
    0.339436062522406545305, 0.351043950788077596670, 0.362598137324667002535, 0.374096854604793138677,
    0.385538343586607379354, 0.396920853982887178457, 0.408242644528790443736, 0.419501983248229015633,
    0.430697147718821948814, 0.441826425335386741011, 0.452888113571928763168, 0.463880520242089311456,
    0.474801963758011202899, 0.485650773387583722940, 0.496425289510026346296, 0.507123863869773039426,
    0.517744859828618064768, 0.528286652616083651779, 0.538747629577973619064, 0.549126190423072424451, 
    0.559420747467953116683, 0.569629725879857162774, 0.579751563917607404264, 0.589784713170519503400,
    0.599727638795273021444, 0.609578819750707823211, 0.619336749030508615377, 0.628999933893742535496,
    0.638566896093214375618, 0.648036172101605134621, 0.657406313335358261085, 0.666675886376279391854,
    0.675843473190817389806, 0.684907671346991042682, 0.693867094228928893429, 0.702720371248990116619,
    0.711466148057433245278, 0.720103086749600440619, 0.728629866070587328686, 0.737045181617363875937,
    0.745347746038318881290, 0.753536289230195444055, 0.761609558532387875829, 0.769566318918569858276,
    0.777405353185625758172, 0.785125462139854901622, 0.792725464780420718824, 0.800204198480017003803,
    0.807560519162723866593, 0.814793301479024401068, 0.821901438977958531673, 0.828883844276383840999,
    0.835739449225321395787, 0.842467205073357483514, 0.849066082627078722034, 0.855535072408516006348,
    0.861873184809570425102, 0.868079450243401717913, 0.874152919292752739189, 0.880092662855188390125,
    0.885897772285227369515, 0.891567359533344316880, 0.897100557281821031630, 0.902496519077426229138,
    0.907754419460903849703, 0.912873454093249270258, 0.917852839878754989122, 0.922691815084806687963,
    0.927389639458410353079, 0.931945594339434579823, 0.936358982770549297392, 0.940629129603843927576,
    0.944755381604109989446, 0.948737107548771163579, 0.952573698324445716779, 0.956264567020127520536,
    0.959809149016969231916, 0.963206902074657089763, 0.966457306414360339808, 0.969559864798246517914,
    0.972514102605546937319, 0.975319567905162609911, 0.977975831524800276462, 0.980482487116625334167,
    0.982839151219423778905, 0.985045463317263281233, 0.987101085894644070251, 0.989005704488130743535,
    0.990759027734458008752, 0.992360787415103029474, 0.993810738497316381590, 0.995108659171606624305,
    0.996254350885672046445, 0.997247638374774703074, 0.998088369688551968473, 0.998776416214261275606,
    0.999311672696455266518, 0.999694057253083134817, 0.999923511388016938994, 1.000000000000000000000
};
#elif defined (MMATH_SIN_4)
/* Not actually useful, other than for testing */
static const double mmath_sin_table[] = {
    0.000000000000000000000, 0.500000000000000000000, 0.866025403784438596588, 1.000000000000000000000
};
#else
    #error "No selected sine table size!"
#endif

#define MMATH_SIN_TABLE_LEN (sizeof(mmath_sin_table) / sizeof(double))

static const double mmath_atan_high_table[] = {
  4.63647609000806093515e-01, /* atan(0.5)hi */
  7.85398163397448278999e-01, /* atan(1.0)hi */
  9.82793723247329054082e-01, /* atan(1.5)hi */
  1.57079632679489655800e+00, /* atan(inf)hi */
};

static const double mmath_atan_low_table[] = {
  2.26987774529616870924e-17, /* atan(0.5)lo */
  3.06161699786838301793e-17, /* atan(1.0)lo */
  1.39033110312309984516e-17, /* atan(1.5)lo */ 
  6.12323399573676603587e-17, /* atan(inf)lo */
};

static const double mmath_atan_table[] = {
  3.33333333333329318027e-01, /* 0x3FD55555, 0x5555550D 0 */ 
 -1.99999999998764832476e-01, /* 0xBFC99999, 0x9998EBC4 1 */
  1.42857142725034663711e-01, /* 0x3FC24924, 0x920083FF 2 */
 -1.11111104054623557880e-01, /* 0xBFBC71C6, 0xFE231671 3 */
  9.09088713343650656196e-02, /* 0x3FB745CD, 0xC54C206E 4 */
 -7.69187620504482999495e-02, /* 0xBFB3B0F2, 0xAF749A6D 5 */
  6.66107313738753120669e-02, /* 0x3FB10D66, 0xA0D03D51 6 */
 -5.83357013379057348645e-02, /* 0xBFADDE2D, 0x52DEFD9A 7*/
  4.97687799461593236017e-02, /* 0x3FA97B4B, 0x24760DEB 8 */
 -3.65315727442169155270e-02, /* 0xBFA2B444, 0x2C6A6C2F */
  1.62858201153657823623e-02, /* 0x3F90AD3A, 0xE322DA11 */
};


double mmath_sind(double input) {
    double x, a, b, findex, frac, sign;
    unsigned index_a, index_b;

    sign = 1.0;
    /* Normalise [0, 2pi] in to [0, 1] */
    x = input / (2.0 * MMATH_PI);
    x -= mmath_floord(x);
    if (x <= 0.5) {
        if (x < 0.25) {
            findex = (x) * ((MMATH_SIN_TABLE_LEN - 1) << 2);
        } else {
            findex = (x - 0.25) * ((MMATH_SIN_TABLE_LEN - 1) << 2);
            findex = (MMATH_SIN_TABLE_LEN - 1) - findex;
        }
    } else {
        sign = -1.0;
        if (x < 0.75) {
            findex = (x - 0.5) * ((MMATH_SIN_TABLE_LEN - 1) << 2);
        } else {
            findex = (x - 0.75) * ((MMATH_SIN_TABLE_LEN - 1) << 2);
            findex = (MMATH_SIN_TABLE_LEN - 1) - findex;
        }
    }

    index_a = mmath_floord(findex);
    index_b = index_a + 1;

    a = mmath_sin_table[index_a & (MMATH_SIN_TABLE_LEN - 1)];
    b = mmath_sin_table[index_b & (MMATH_SIN_TABLE_LEN - 1)];

    frac = findex - mmath_floord(findex);

    return sign * (((1.0 - frac) * a) + (frac * b));
;
}

float mmath_sinf(float x) {
    return 0.0;
}

double mmath_cosd(double x) {
    return mmath_sind(x + (MMATH_PI / 2.0));
}

float mmath_cosf(float x) {
    return mmath_sinf(x + (MMATH_PI / 2.0));
}

/* https://github.com/xiezhq-hermann/atan_lookup/blob/master/atan.cpp */
float mmath_atanf(float x) {
    return 0.0;
}

float mmath_arctan2f(float x, float y) {

}

double mmath_arctan2d(double x, double y) {
    
}

int mmath_floord(double x) {
    int result = (int)x;
    return x < result ? result - 1 : result;
}

int mmath_floorf(float x) {
    int result = (int)x;
    return x < result ? result - 1 : result;
}

int mmath_ceild(double x) {
    int result = (int)x;
    return x > result ? result + 1 : result;
}

int mmath_ceilf(float x) {
    int result = (int)x;
    return x > result ? result + 1 : result;
}

float mmath_truncf(float x) {
    return (float)mmath_floorf(x);
}

double mmath_truncd(double x) {
    return (double)mmath_floord(x);
}

float mmath_fabsf(float x) {
    return (x < 0.0) ? -x : x;
}

double mmath_fabsd(double x) {
    return (x < 0.0) ? -x : x;
}

float mmath_fmodf(float x, float y) {
    return x - mmath_truncf(x / y) * y;
}

double mmath_fmodd(double x, double y) {
    return x - mmath_truncd(x / y) * y;
}

/* https://git.musl-libc.org/cgit/musl/tree/src/math/atan.c */

/* atan(x)
 * Based on: FreeBSD /usr/src/lib/msun/src/s_atan.c
 * Method
 *   1. Reduce x to positive by atan(x) = -atan(-x).
 *   2. According to the integer k=4t+0.25 chopped, t=x, the argument
 *      is further reduced to one of the following intervals and the
 *      arctangent of t is evaluated by the corresponding formula:
 *
 *      [0, 0.4375]   atan(x) = t-t^3*(a1+t^2*(a2+...(a10+t^2*a11)...)
 *      [7/16,11/16]  atan(x) = atan(1/2) + atan( (t-0.5)/(1+t/2) )
 *      [11/16,19/16] atan(x) = atan( 1 ) + atan( (t-1)/(1+t) )
 *      [19/16,39/16] atan(x) = atan(3/2) + atan( (t-1.5)/(1+1.5t) )
 *      [39/16,INF]   atan(x) = atan(INF) + atan( -1/t )
 */
double mmath_atand(double x) {
    int id;
    double sign = (x < 0.0) ? -1.0 : 1.0;
    double abs_x = mmath_fabsd(x);
    double temp, x_2, x_4, sum_1, sum_2;

    if (abs_x < 1.1875) {
        if (abs_x < 0.4375) {
            /* 0 ... 0.4375 */
            id = -1;
        } else if (abs_x < 0.6875) {
            /* 0.4375 ... 0.6875 */
            x = ((2.0 * x) - 1.0) / (2.0 + x);
            id = 0;
        } else {
            /* 0.6875 ... 1.1875 */
            x = (x - 1.0) / (x + 1.0);
            id = 1;
        }
    } else {
        if (abs_x < 2.4375) {
            /* 1.1875 ... 2.4375 */
            x = (x - 1.5) / (1.0 + (1.5 * x));
            id = 2;
        } else {
            /* 2.4375 ... INF */
            x = -1.0 / x;
            id = 3;
            if (abs_x > 7.3786976e+19) {
                /* > 2^66 */
                return sign * mmath_atan_high_table[3];
            }
        }
    }

    x_2 = x * x;
    x_4 = x_2 * x_2;
    /* break sum from i=0 to 10 mmath_atan_table[i]z**(i+1) into odd and even poly */
	sum_1 = x_2 * (mmath_atan_table[0] + x_4 * (
                        mmath_atan_table[2] + x_4 * (
                            mmath_atan_table[4] + x_4 * (
                                mmath_atan_table[6] + x_4 * (
                                    mmath_atan_table[8] + x_4 * mmath_atan_table[10])))));
	sum_2 = x_4 * (mmath_atan_table[1] + x_4 * (
                        mmath_atan_table[3] + x_4 * (
                            mmath_atan_table[5] + x_4 * (
                                mmath_atan_table[7] + x_4 * mmath_atan_table[9]))));

    if (id < 0) {
        return x - (x * (sum_1 + sum_2));
    }
    return sign * (mmath_atan_high_table[id] - (x * (sum_1 + sum_2) - mmath_atan_low_table[id] - x));
}

/*

double atan(double x)
{
	double_t w,s1,s2,z;
	uint32_t ix,sign;
	int id;

	GET_HIGH_WORD(ix, x);
	sign = ix >> 31;
	ix &= 0x7fffffff;
	if (ix >= 0x44100000) {   // if |x| >= 2^66 
		if (isnan(x))
			return x;
		z = atanhi[3] + 0x1p-120f;
		return sign ? -z : z;
	}
	if (ix < 0x3fdc0000) {    // |x| < 0.4375 
		if (ix < 0x3e400000) {  // |x| < 2^-27
			if (ix < 0x00100000)
				// raise underflow for subnormal x
				FORCE_EVAL((float)x);
			return x;
		}
		id = -1;
	} else {
		x = fabs(x);
		if (ix < 0x3ff30000) {  // |x| < 1.1875
			if (ix < 0x3fe60000) {  //  7/16 <= |x| < 11/16
				id = 0;
				x = (2.0*x-1.0)/(2.0+x);
			} else {                // 11/16 <= |x| < 19/16
				id = 1;
				x = (x-1.0)/(x+1.0);
			}
		} else {
			if (ix < 0x40038000) {  // |x| < 2.4375
				id = 2;
				x = (x-1.5)/(1.0+1.5*x);
			} else {                // 2.4375 <= |x| < 2^66
				id = 3;
				x = -1.0/x;
			}
		}
	}
	// end of argument reduction
	z = x*x;
	w = z*z;
	// break sum from i=0 to 10 aT[i]z**(i+1) into odd and even poly
	s1 = z*(aT[0]+w*(aT[2]+w*(aT[4]+w*(aT[6]+w*(aT[8]+w*aT[10])))));
	s2 = w*(aT[1]+w*(aT[3]+w*(aT[5]+w*(aT[7]+w*aT[9]))));
	if (id < 0)
		return x - x*(s1+s2);
	z = atanhi[id] - (x*(s1+s2) - atanlo[id] - x);
	return sign ? -z : z;
} */

// https://gist.github.com/serg06/38760a4b5aceb4c6245d61c56716588c

double mmath_deg_to_rad(double x) {
    return x * (MMATH_PI / 180.0);
}

double mmath_rad_to_deg(double x) {
    return x * (180.0 / MMATH_PI);
}
